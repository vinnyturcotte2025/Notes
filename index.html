<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Notes by Enzo</title>

  <style>
    :root {
      --bg: #020617;
      --card: #020617;
      --text: #e5e7eb;
      --muted: #94a3b8;
      --accent: #2563eb;
      --border: #334155;
    }

    body.light {
      --bg: #f8fafc;
      --card: #ffffff;
      --text: #020617;
      --muted: #475569;
      --accent: #2563eb;
      --border: #cbd5f5;
    }

    body {
      margin: 0;
      font-family: Arial, Helvetica, sans-serif;
      background: var(--bg);
      color: var(--text);
      height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
    }

    .app {
      width: 92%;
      max-width: 800px;
      background: var(--card);
      padding: 24px;
      border-radius: 14px;
      box-shadow: 0 0 40px rgba(0,0,0,0.5);
    }

    h1 {
      text-align: center;
      margin-bottom: 8px;
      letter-spacing: 1px;
    }

    .subtitle {
      text-align: center;
      color: var(--muted);
      font-size: 0.9rem;
      margin-bottom: 16px;
    }

    .controls {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      justify-content: center;
      margin-bottom: 14px;
    }

    button {
      padding: 9px 14px;
      font-size: 0.95rem;
      border-radius: 8px;
      border: none;
      cursor: pointer;
      background: var(--accent);
      color: white;
    }

    button.secondary {
      background: #475569;
    }

    button:disabled {
      opacity: 0.6;
      cursor: not-allowed;
    }

    textarea {
      width: 100%;
      height: 260px;
      background: transparent;
      color: var(--text);
      border: 1px solid var(--border);
      border-radius: 10px;
      padding: 12px;
      font-size: 1rem;
      resize: none;
      margin-bottom: 12px;
    }

    .status {
      text-align: center;
      font-size: 0.85rem;
      color: var(--muted);
    }

    .summary {
      margin-top: 14px;
      padding: 12px;
      border-radius: 10px;
      background: rgba(37,99,235,0.08);
      font-size: 0.95rem;
    }
  </style>
</head>

<body>
  <div class="app">
    <h1>Notes by Enzo</h1>
    <div class="subtitle">Speak your mind. The page remembers.</div>

    <div class="controls">
      <button id="startBtn">üéô Start</button>
      <button id="stopBtn" disabled>‚èπ Stop</button>
      <button id="clearBtn" class="secondary">üßπ Clear</button>
      <button id="exportBtn" class="secondary">üìÑ Export</button>
      <button id="summaryBtn" class="secondary">üß† Summarize</button>
      <button id="themeBtn" class="secondary">üåó Theme</button>
    </div>

    <textarea id="notes" placeholder="Your words land here..."></textarea>

    <div class="status" id="status">Idle</div>

    <div class="summary" id="summary" style="display:none;"></div>
  </div>

  <script>
    const notes = document.getElementById("notes");
    const statusText = document.getElementById("status");
    const summaryBox = document.getElementById("summary");

    // ---- Local Storage ----
    notes.value = localStorage.getItem("enzo-notes") || "";
    document.body.className = localStorage.getItem("enzo-theme") || "";

    notes.addEventListener("input", () => {
      localStorage.setItem("enzo-notes", notes.value);
    });

    // ---- Speech Recognition ----
    const SpeechRecognition =
      window.SpeechRecognition || window.webkitSpeechRecognition;

    let recognition;
    let finalText = notes.value;

    if (SpeechRecognition) {
      recognition = new SpeechRecognition();
      recognition.continuous = true;
      recognition.interimResults = true;
      recognition.lang = "en-US";

      recognition.onstart = () => {
        statusText.textContent = "Listening‚Ä¶";
        startBtn.disabled = true;
        stopBtn.disabled = false;
      };

      recognition.onend = () => {
        statusText.textContent = "Stopped";
        startBtn.disabled = false;
        stopBtn.disabled = true;
      };

      recognition.onresult = (e) => {
        let interim = "";

        for (let i = e.resultIndex; i < e.results.length; i++) {
          let text = e.results[i][0].transcript;

          if (e.results[i].isFinal) {
            text = text.trim();
            if (!/[.!?]$/.test(text)) text += ".";
            finalText += text + " ";
          } else {
            interim += text;
          }
        }

        notes.value = finalText + interim;
        localStorage.setItem("enzo-notes", notes.value);
      };
    } else {
      statusText.textContent = "Speech recognition not supported.";
      startBtn.disabled = true;
    }

    startBtn.onclick = () => recognition && recognition.start();
    stopBtn.onclick = () => recognition && recognition.stop();

    // ---- Clear ----
    clearBtn.onclick = () => {
      if (!confirm("Clear all notes?")) return;
      notes.value = "";
      finalText = "";
      summaryBox.style.display = "none";
      localStorage.removeItem("enzo-notes");
    };

    // ---- Export ----
    exportBtn.onclick = () => {
      const blob = new Blob([notes.value], { type: "text/plain" });
      const link = document.createElement("a");
      link.href = URL.createObjectURL(blob);
      link.download = "Notes_by_Enzo.txt";
      link.click();
    };

    // ---- Theme ----
    themeBtn.onclick = () => {
      document.body.classList.toggle("light");
      localStorage.setItem("enzo-theme", document.body.className);
    };

    // ---- Summary (Offline) ----
    summaryBtn.onclick = () => {
      const text = notes.value.trim();
      if (!text) return;

      const sentences = text.split(/[.!?]/).filter(Boolean);
      const top = sentences.slice(0, 3).join(". ") + ".";

      summaryBox.textContent =
        "Summary: " + top;

      summaryBox.style.display = "block";
    };
  </script>
</body>
</html>
